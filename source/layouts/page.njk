{% extends "./base.njk" %}

{% block header %}
  <nav class="banner">
    <ul>
      {% for item in globalNavigation %}
        <li class="{{ item.id }}" class="banner__navigation-item"><a class="banner__navigation-link" href="{{ item.href }}"{% if page.navigationId == item.id %} aria-current="page"{% endif %}>{{ item.title }}</a></li>
      {% endfor %}
    </ul>
  </nav>
  {% if page.navigationId != 'homepage' %}
  <div class="title">
  {% block title %}
    <h1>{{ title }}</h1>
    {% if not hideDate %}
    <time datetime="{{ date | date('') }}">{{ date | date }}</time>
    {% endif %}
  {% endblock %}
  </div>
  {% endif %}
{% endblock %}

{% macro renderPhotos(photos) %}
{% for p in photos -%}
  {% figure p.url, p.alt %}
{%- endfor %}
{% endmacro %}

{% block content %}
  <div class="prose">
    {{ content | hangingPunctuation | safe }}
    {% if photo %}
      {% if photo | length > 1 %}
        <div class="gallery">
        {{ renderPhotos(photo) }}
        </div>
      {% else %}
        {{ renderPhotos(photo) }}
      {% endif %}
    {% endif %}
  </div>
{% endblock %}

{% if page.collectionId == 'diary' or page.collectionId == 'articles' %}
  {% set count = 0 %}
  {% set prevPost = null %}
  {% set nextPost = null %}
  {%- for post in collections[page.collectionId] -%}
    {% if post.url == page.url %}
      {% set prevPost = collections[page.collectionId][count + 1] %}
      {% set nextPost = collections[page.collectionId][count - 1] %}
    {% endif %}
    {% set count = count + 1 %}
  {%- endfor -%}

{% block pageNavigation %}
  <nav aria-label="tags">
    <ul>
      {% for tag in tags %}
        <li><a href="/tags/{{ tag | slug }}" rel="tag">{{ tag }}</a></li>
      {% endfor %}
    </ul>
  </nav>
  <nav aria-label="pagination">
    <ul>
      {% if prevPost %}<li>Previous {{ type.title }}: <a href="{{ prevPost.url }}" rel="prev">{{ prevPost.data.title }}</a></li>{% endif %}
      {% if nextPost %}<li>Next {{ type.title }}: <a href="{{ nextPost.url }}" rel="next">{{ nextPost.data.title }}</a></li>{% endif %}
    </ul>
  </nav>
{% endblock %}
{% endif %}

{% block footer %}
  <p class="copyright">&copy; Copyright, {{ collections.stats.allPosts.earliest | date('YYYY') }} to {{ collections.stats.allPosts.latest | date('YYYY') }} Jon Roobottom</p>
{% endblock %}